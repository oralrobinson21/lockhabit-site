<!doctype html>
<html lang="en">
<head>
  <!-- =========================================================
       LockHabit — Home (Hero demo + APR selector + mini-game)
       Apple/Tesla-level cleanliness • A11y • SEO • Perf
       ========================================================= -->
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>LockHabit — Discipline Pays. Lock Your Money. Own Your Future.</title>
  <meta name="description" content="Hard-lock savings that grow at a transparent APR. Start from $200/month, watch your deposited, interest, and total vested update in real time. Optional self-backed emergency credit. Try the calculator and live demo."/>
  <meta name="theme-color" content="#6f7cff"/>

  <!-- Canonical + Social -->
  <link rel="canonical" href="https://lockhabit.com/"/>
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="LockHabit — Discipline Pays. Lock Your Money. Own Your Future."/>
  <meta property="og:description" content="See your goal progress live: deposited, interest, and total vested. Optional self-backed emergency loans. Join the waitlist, try the calculator, or open the live demo."/>
  <meta property="og:url" content="https://lockhabit.com/"/>
  <meta property="og:image" content="/public/og-image.png"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="LockHabit — Save on purpose"/>
  <meta name="twitter:description" content="Check your take-home, build a plan, and see your savings grow in the live demo."/>
  <meta name="twitter:image" content="/public/og-image.png"/>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>

  <!-- Icons & PWA -->
  <link rel="icon" href="/public/favicon.svg" type="image/svg+xml">
  <link rel="alternate icon" href="/public/favicon.ico">
  <link rel="apple-touch-icon" href="/public/icon-192.png">
  <link rel="manifest" href="/public/manifest.webmanifest">

  <!-- Analytics -->
  <script defer data-domain="lockhabit.com" src="https://plausible.io/js/script.js"></script>

  <!-- ========================= Styles ========================= -->
  <style>
    :root{
      --brand:#6f7cff; --brand2:#9c78ff; --accent:#9fb2ff;
      --green:#22c55e; --ink:#0f172a; --ink2:#15213d; --muted:#536179;
      --line:#e6e7f1; --panel:#ffffff; --surface:#fbfcff;
      --bg:#0b0e1a; --bg2:#0e1330;
      --radius:16px; --radius-lg:22px;
      --shadow-elev:0 18px 50px rgba(17,24,39,.10);
      --shadow-deep:0 40px 120px rgba(7,10,18,.45);
      --grad-hero:
        radial-gradient(1300px 720px at 50% -220px, rgba(111,124,255,.28) 0%, rgba(156,120,255,.20) 35%, transparent 62%),
        radial-gradient(1000px 680px at -8% 8%, rgba(156,120,255,.20) 0%, transparent 55%),
        radial-gradient(1000px 680px at 108% -12%, rgba(111,124,255,.16) 0%, transparent 60%),
        #f7f8ff;
      --safe-bottom: env(safe-area-inset-bottom, 0px);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font:16px/1.6 Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      padding-bottom:var(--safe-bottom); overflow-x:hidden;
    }
    a{color:#19253f; text-decoration:none; font-weight:600}

    /* Header */
    .header{position:sticky;top:0;z-index:60;background:rgba(255,255,255,.9);backdrop-filter:blur(10px);border-bottom:1px solid var(--line);transition:transform .18s ease, box-shadow .18s ease}
    .header.hide{transform:translateY(-100%)}
    .header.stuck{box-shadow:0 6px 22px rgba(15,23,42,.08)}
    .wrap{max-width:1200px;margin:0 auto;padding:12px 18px;display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:32px;height:32px}
    .word{font-weight:800;color:#0e1a34;font-size:20px}
    .nav{display:flex;align-items:center;gap:14px}
    .btn{appearance:none;border:1px solid var(--line);background:#fff;padding:10px 14px;border-radius:12px;font-weight:800;cursor:pointer;min-height:44px}
    .btn.acc{background:linear-gradient(135deg,var(--brand),var(--brand2));color:#fff;border:0;box-shadow:0 10px 26px rgba(111,124,255,.32)}
    .btn.ghost{background:transparent}
    .btn.pill{border-radius:999px}
    @media (max-width:760px){ .nav a:nth-child(-n+4){display:none} }

    /* Hero */
    .hero{background:var(--grad-hero);border-bottom:1px solid var(--line);padding:60px 18px 44px}
    .hero-grid{max-width:1200px;margin:0 auto;display:grid;grid-template-columns:1fr;gap:24px;align-items:center}
    @media (min-width:1020px){ .hero-grid{grid-template-columns:1.05fr .95fr;gap:28px} }
    h1{font-size:34px;line-height:1.12;margin:0 0 10px}
    @media (min-width:540px){ h1{font-size:42px} }
    @media (min-width:1020px){ h1{font-size:50px} }
    .sub{color:#3a4a66;max-width:68ch}
    .chip{display:flex;gap:10px;flex-wrap:wrap;align-items:center;background:linear-gradient(135deg,#e7ebff,#f4f1ff);border:1px solid #dfe3ff;border-radius:999px;padding:8px 12px;font-weight:700;color:#3a4a66}
    .cta{display:flex;gap:10px;margin-top:16px;flex-wrap:wrap}
    .footnote{font-size:12px;color:#60708c}

    /* Hero mock */
    .mock{background:#fff;border:1px solid var(--line);border-radius:20px;padding:16px;box-shadow:var(--shadow-elev)}
    .mock .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .badge{background:#eafff2;color:#0b3b22;border:1px solid #c8f5d9;padding:6px 10px;border-radius:999px;font-weight:800;white-space:nowrap}
    .mini{font-size:12px;color:var(--muted)}
    .card{margin-top:12px;background:linear-gradient(180deg,#fff,#f9f9ff);border:1px solid var(--line);border-radius:14px;padding:12px}
    .bar{height:10px;border-radius:999px;background:#edf0f6;overflow:hidden;border:1px solid #e5e8f1}
    .fill{height:100%;width:0;background:linear-gradient(90deg,#22c55e,var(--brand));transition:width .6s ease}
    .statgrid{display:grid;grid-template-columns:1fr;gap:10px;margin-top:12px}
    @media (min-width:560px){ .statgrid{grid-template-columns:repeat(3,minmax(0,1fr))} }
    .stat{background:#fff;border:1px solid var(--line);border-radius:12px;padding:12px}
    .k{font-size:12px;color:#5c6b86;letter-spacing:.04em;text-transform:uppercase}
    .v{font-weight:800;font-size:22px;color:#0b1230;line-height:1.2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

    .aprRow{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .pill{display:inline-flex;align-items:center;gap:8px;border:1px solid #e1e6ff;background:#f3f6ff;border-radius:999px;padding:8px 12px;font-weight:700;color:#203060;cursor:pointer}
    .pill.is-active{border-color:#b8c2ff;box-shadow:0 0 0 2px #e7ebff inset}
    .pill input{width:84px;padding:6px 8px;border:1px solid #dbe0ea;border-radius:10px;font-weight:700}

    .emerg{display:flex;align-items:center;gap:8px;background:#f3f5ff;border:1px solid #e1e6ff;border-radius:12px;padding:10px 12px;margin-top:10px;font-weight:700;color:#203060;flex-wrap:wrap}

    /* Sections */
    section.s{max-width:1200px;margin:0 auto;padding:40px 18px}
    .section-title{font-size:28px;text-align:center;margin:0 0 16px;color:#f8f9ff}
    .panel{background:#fff;border:1px solid var(--line);border-radius:16px;padding:18px;box-shadow:var(--shadow-elev)}
    .cols3{display:grid;grid-template-columns:1fr;gap:12px}
    @media (min-width:900px){ .cols3{grid-template-columns:repeat(3,minmax(0,1fr))} }
    .plan{background:#fff;border:1px solid var(--line);border-radius:16px;padding:16px}
    .plan h3{margin:0 0 6px;color:#15213d}

    /* Ribbon */
    .ribbon{background:linear-gradient(135deg, rgba(111,124,255,.22), rgba(156,120,255,.22));border-top:1px solid var(--line);border-bottom:1px solid var(--line)}
    .ribwrap{max-width:1200px;margin:0 auto;padding:12px 18px;display:flex;gap:10px;align-items:center;justify-content:center;color:#e7ebff;flex-wrap:wrap}
    .ribwrap .item{display:flex;align-items:center;gap:8px;background:rgba(255,255,255,.18);border:1px solid rgba(255,255,255,.25);padding:10px 12px;border-radius:999px}
    .ribwrap .item b{color:#fff}

    /* Footer */
    footer{background:#fff;border-top:1px solid var(--line);color:#3a4a66}
    .foot{max-width:1200px;margin:0 auto;padding:22px 18px}
    .fine{background:#f6f7fc;border:1px solid var(--line);border-radius:12px;padding:12px;margin-top:12px;font-size:12px;color:#41506a}
    .footnote{font-size:12px;color:#60708c}

    /* Modal */
    .overlay{position:fixed;inset:0;background:rgba(9,12,22,.55);backdrop-filter:blur(3px);display:none;align-items:center;justify-content:center;z-index:90}
    .modal{width:min(560px,92vw);background:#fff;border:1px solid var(--line);border-radius:16px;padding:18px;box-shadow:var(--shadow-deep)}
    .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .x{border:0;background:transparent;font-size:20px;cursor:pointer;color:#64748b}
    .form{display:grid;gap:10px;margin-top:10px}
    input,select{padding:14px;border-radius:12px;border:1px solid #dbe0ea;font-size:16px}
    .note{font-size:12px;color:#60708c}
    .success{display:none;text-align:center;padding:18px}
    .check{font-size:42px}

    /* Mini Game */
    .miniwrap{position:fixed;left:0;right:0;bottom:0;z-index:40;pointer-events:none;padding-bottom:var(--safe-bottom)}
    .minibar{margin:0 auto;max-width:1200px;padding:6px 10px;display:flex;gap:8px;align-items:center;justify-content:flex-end}
    .minibar .pill{pointer-events:auto;display:inline-flex;align-items:center;gap:8px;background:#0e1330;color:#e5e7f1;border:1px solid #2b3150;border-radius:999px;padding:6px 10px;font-weight:700;cursor:pointer;min-height:36px}
    #gamePanel{pointer-events:auto;display:none;background:#0b0e1a;border-top:1px solid #2b3150}
    #gamePanel.open{display:block}
    #runnerCanvas{display:block;width:100%;max-width:1200px;height:140px;margin:0 auto;background:#0f172a}
    #gameInfo,#gameUI{max-width:1200px;margin:0 auto;color:#9fb2ff;font-size:12px;padding:6px 10px;display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    #top10{display:flex;gap:6px;flex-wrap:wrap;padding:0;margin:0;list-style:none}
    #playerName{padding:6px 8px;border-radius:10px;border:1px solid #2b3150;background:#0e1330;color:#e5e7f1}
    .gameOver{max-width:1200px;margin:6px auto 10px;display:none;gap:10px;align-items:center;justify-content:space-between;color:#e6ebff}
    .gameOver .card{background:#0e1330;border:1px solid #2b3150;border-radius:12px;padding:10px;display:flex;gap:10px;align-items:center;justify-content:space-between}
    .gameOver .btn{background:#162048;color:#e6ebff;border-color:#2b3150}

    @media (max-width:420px){
      .word{font-size:18px}
      .btn{padding:10px 12px}
    }
  </style>
</head>
<body>

<!-- ========================= HEADER ========================= -->
<header class="header" role="banner" id="hdr">
  <div class="wrap">
    <div class="brand" aria-label="LockHabit">
      <svg class="logo" viewBox="0 0 120 120" aria-hidden="true">
        <defs><linearGradient id="lg" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#6f7cff"/><stop offset="100%" stop-color="#9c78ff"/></linearGradient></defs>
        <rect x="12" y="22" width="96" height="80" rx="18" fill="url(#lg)"/>
        <path d="M40 50c0-16 12-28 28-28s28 12 28 28" fill="none" stroke="#ffffff" stroke-width="8" stroke-linecap="round"/>
        <path d="M40 90V58" stroke="#ffffff" stroke-width="10" stroke-linecap="round"/>
        <path d="M40 90h26" stroke="#e7ecf8" stroke-width="8" stroke-linecap="round"/>
      </svg>
      <div class="word">LockHabit</div>
    </div>
    <nav class="nav" role="navigation" aria-label="Main">
      <a href="#how">How it works</a>
      <a href="#plans">Plans</a>
      <a href="#security">Security</a>
      <a href="/calculator.html">Calculator</a>
      <a href="/demo.html">Demo</a>
      <button class="btn acc" onclick="openModal()">Get started</button>
    </nav>
  </div>
</header>

<!-- ========================= HERO ========================= -->
<section class="hero" id="top">
  <div class="hero-grid" aria-describedby="hero-copy">
    <div>
      <div class="chip">Discipline Pays • <b style="color:#22c55e">Fixed APR</b> tiers • FDIC-Backed Custody</div>
      <h1>Discipline pays. Lock your money and own your future.</h1>
      <p id="hero-copy" class="sub">
        We start with <b>$200/month</b> by default and show your <b>Deposited</b>, <b>Interest</b>, and <b>Total vested</b>.
        In a real emergency, you can access a self-backed loan up to <b>80% of vested</b> (see terms).  
        Prefer numbers first? <a href="/calculator.html">Open Calculator</a>. Ready to feel it? <a href="/demo.html">Try the Demo</a>.
      </p>
      <div class="cta">
        <button class="btn acc" onclick="openModal()">Join the Waitlist</button>
        <a class="btn" href="/calculator.html">Open Calculator</a>
        <a class="btn" href="/demo.html">Try the Demo</a>
      </div>
      <div class="footnote">Your deposits are never lent out. We don’t say “guaranteed” beyond posted fixed APRs.</div>
    </div>

    <!-- Right: interactive mock -->
    <aside class="mock" aria-live="polite">
      <div class="row">
        <div>
          <div class="mini">Savings Vault</div>
          <div style="font-weight:800;font-size:18px;color:#0f1a34">Goal Progress</div>
          <div class="mini" id="planLine"><span id="mDep">$200</span>/mo • <span id="mTerm">12 months</span> • <span id="mAPR">3.0% APR</span></div>
        </div>
        <span class="badge">On-time ↑ credit</span>
      </div>

      <div class="card" style="margin-top:10px">
        <div class="row" style="margin-bottom:8px">
          <div class="mini">Progress</div>
          <div class="mini" id="pval">0%</div>
        </div>
        <div class="bar" aria-hidden="true"><div class="fill" id="pbar"></div></div>

        <!-- APR & inputs -->
        <div class="aprRow" aria-label="APR selector">
          <button class="pill is-active" data-apr="0.02">2.0%</button>
          <button class="pill" data-apr="0.025">2.5%</button>
          <button class="pill" data-apr="0.03">3.0%</button>
          <button class="pill" data-apr="0.035">3.5%</button>
          <span class="pill" id="customAPRpill">Custom
            <input type="number" id="aprCustom" step="0.01" min="0" max="0.2" placeholder="0.03"/>
          </span>
          <span class="pill">Deposit <input type="number" id="depInput" min="0" value="200"/></span>
          <span class="pill">Term (mo) <input type="number" id="termInput" min="1" value="12"/></span>
        </div>
      </div>

      <div class="statgrid">
        <div class="stat">
          <div class="k">Deposited so far</div>
          <div class="v" id="vDeposited">$0.00</div>
          <div class="k">Monthly deposits</div>
        </div>
        <div class="stat">
          <div class="k">Interest so far</div>
          <div class="v" id="vInterest">$0.00</div>
          <div class="k">Compounded monthly at APR</div>
        </div>
        <div class="stat">
          <div class="k">Total vested</div>
          <div class="v" id="vTotal">$0.00</div>
          <div class="k">Principal + interest</div>
        </div>
      </div>

      <div class="emerg">
        💡 Emergency access (self-backed): up to <b>80% of vested</b>.
        Terms: <b>0%</b> for first 4 months, then <b>6% APR</b>. Credit-builder loans at <b>6% APR</b> (intended to be bureau-reported).
      </div>
    </aside>
  </div>
</section>

<!-- ========================= RIBBON ========================= -->
<div class="ribbon" role="region" aria-label="Security summary">
  <div class="ribwrap">
    <div class="item">🔒 <b>Hard-lock</b> (no early withdrawals except emergencies)</div>
    <div class="item">🏦 <b>FDIC-backed custody</b> via partner banks</div>
    <div class="item">🧮 <b>Fixed APR tiers</b>: 2.0% • 2.5% • 3.0% • 3.5%</div>
    <div class="item">⚠️ <b>Optional high-risk sleeve</b>: variable APR (historically –10% to +20%). Not guaranteed; capital at risk.</div>
  </div>
</div>

<!-- ========================= HOW IT WORKS ========================= -->
<section id="how" class="s" aria-labelledby="how-title">
  <h2 id="how-title" class="section-title">How LockHabit Works</h2>
  <div class="panel">
    <div class="cols3">
      <div class="plan">
        <h3>1) Choose your lock</h3>
        <ul>
          <li>Pick a term (3–6–12–24+ months)</li>
          <li>Start with $200/mo (or set your own)</li>
          <li>Funds move into your hidden vault</li>
        </ul>
      </div>
      <div class="plan">
        <h3>2) Grow automatically</h3>
        <ul>
          <li>Fixed APR tiers: 2.0% / 2.5% / 3.0% / 3.5%</li>
          <li>Your deposits are <b>never lent out</b></li>
          <li>Optional high-risk sleeve (variable; can lose value)</li>
        </ul>
      </div>
      <div class="plan">
        <h3>3) Unlock or borrow</h3>
        <ul>
          <li>Unlock day: principal + interest − posted fees</li>
          <li>Emergency? Borrow against your own balance</li>
          <li>Intended to be credit-bureau reported</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- ========================= PLANS ========================= -->
<section id="plans" class="s" aria-labelledby="plans-title">
  <h2 id="plans-title" class="section-title">Simple, transparent plans</h2>
  <div class="cols3">
    <div class="plan">
      <h3>3–5 months</h3>
      <ul>
        <li><b>2.0% APR</b> (prorated)</li>
        <li>Small flat unlock fee</li>
        <li>Great for quick goals</li>
      </ul>
    </div>
    <div class="plan">
      <h3>6–11 months</h3>
      <ul>
        <li><b>2.5% APR</b> (prorated)</li>
        <li>Balanced discipline</li>
        <li>Extendable at maturity</li>
      </ul>
    </div>
    <div class="plan">
      <h3>12–24+ months</h3>
      <ul>
        <li><b>3.0%–3.5% APR</b> (prorated)</li>
        <li>Maximum growth in fixed tiers</li>
        <li>Extend to keep building</li>
      </ul>
    </div>
  </div>
  <p class="footnote" style="max-width:1200px;margin:10px auto 0;padding:0 18px">
    Fixed-rate plans are separate from the optional high-risk sleeve. The high-risk sleeve has a <b>variable APR</b> (historically –10% to +20%), can lose value,
    includes a <b>$2/month</b> account fee while enabled and a <b>2% close-out fee</b> at withdrawal/transfer. Availability subject to program and regulatory approval.
    Returns are <b>not guaranteed</b>. This is <b>not investment advice</b>.
  </p>
</section>

<!-- ========================= SECURITY ========================= -->
<section id="security" class="s" aria-labelledby="sec-title">
  <h2 id="sec-title" class="section-title">Your money stays safe</h2>
  <div class="panel">
    <div class="cols3">
      <div class="plan">
        <h3>FDIC-backed via partner banks</h3>
        <p class="mini">When structured for pass-through coverage, FDIC insurance applies up to legal limits per depositor, per bank.</p>
      </div>
      <div class="plan">
        <h3>Segregated & never lent</h3>
        <p class="mini">Your funds remain reserved for you — we do not lend out customer deposits. Emergency access is a secured, self-backed loan to you, not others.</p>
      </div>
      <div class="plan">
        <h3>Hard-lock with emergency override</h3>
        <p class="mini">Withdrawals aren’t allowed before the unlock date except for approved emergencies. Non-emergency early break attempts incur posted fees.</p>
      </div>
    </div>
  </div>
</section>

<!-- ========================= FAQ ========================= -->
<section id="faq" class="s" aria-labelledby="faq-title">
  <h2 id="faq-title" class="section-title">FAQ</h2>
  <div class="panel">
    <details>
      <summary>Is this a hard lock?</summary>
      <p>Yes. Funds remain locked until the chosen unlock date. Early withdrawal is not permitted except for approved emergencies. Non-emergency early break attempts incur posted fees.</p>
    </details>
    <details>
      <summary>Do I earn interest while locked?</summary>
      <p>Yes. Fixed plans accrue based on the posted APR tier (e.g., 2.0%–3.5%), prorated by time in lock. Rates may change with notice for new locks.</p>
    </details>
    <details>
      <summary>What about the high-risk option?</summary>
      <p>
        It’s an <b>optional</b> sleeve available after 5 months of active deposits or when balance ≥ $5,000. It targets diversified ETF exposure with
        <b>variable returns</b> — historically between <b>–10% and +20%</b> — and can <b>lose value</b>. Fees: <b>$2/month</b> when enabled and a <b>2% close-out fee</b>
        at withdrawal/transfer. Availability subject to partner, regulatory, and program approval. Returns are <b>not guaranteed</b>. This is <b>not investment advice</b>.
      </p>
    </details>
    <details>
      <summary>Who is this good for?</summary>
      <p>People who want disciplined savings toward a goal (car, home, tuition) and people who struggle with impulse spending (e.g., gambling or shopping) and
      want a hard boundary. We help you save on purpose so you don’t waste it.</p>
    </details>
  </div>
</section>

<!-- ========================= FOOTER ========================= -->
<footer role="contentinfo">
  <div class="foot">
    <div>© <span id="yr"></span> LockHabit — Discipline made simple. Contact: <a href="mailto:lockhabit@outlook.com">lockhabit@outlook.com</a></div>
    <div class="fine">
      LockHabit is a financial technology company, not a bank. Banking services and deposit custody are provided by regulated partner banks.
      When deposits are held at partner banks and structured for pass-through coverage, funds may be eligible for FDIC insurance up to the applicable limits per depositor, per bank.
      This is a <b>hard lock</b>: early withdrawal is not permitted except for approved emergencies. Emergency access is provided via secured, self-backed loans (0% for the first 4 months, then 6% APR). 
      Credit-builder loans at 6% APR are intended to be bureau-reported. APRs, terms, and fees are subject to change with notice.
    </div>
    <div class="footnote" style="margin-top:8px;text-align:center">
      <a href="/terms.html">Terms</a> • <a href="/privacy.html">Privacy</a> • <a href="/security.html">Security</a> • <a href="/calculator.html">Calculator</a> • <a href="/demo.html">Demo</a>
    </div>
  </div>
</footer>

<!-- ========================= MINI GAME (Footer) ========================= -->
<div class="miniwrap" aria-hidden="false">
  <div class="minibar">
    <button id="toggleGame" class="pill" aria-expanded="false" aria-controls="gamePanel">🎮 Mini game (off)</button>
  </div>
  <div id="gamePanel" role="region" aria-label="Endless runner mini game">
    <canvas id="runnerCanvas" width="1200" height="140"></canvas>
    <div id="gameInfo">
      <span>Until launch: Space/↑ to jump • P pause • R reset</span>
      <span id="gameScore">Score: 0</span>
    </div>
    <div class="gameOver" id="gameOverBox">
      <div class="card" style="width:100%">
        <div><b>Game over.</b> Your score: <span id="finalScore">0</span></div>
        <div style="display:flex;gap:8px">
          <button class="btn" id="tryAgainBtn">Try again</button>
          <button class="btn" id="closeGameBtn">Close</button>
        </div>
      </div>
    </div>
    <div id="gameUI">
      <input id="playerName" placeholder="Enter name (optional)" maxlength="12"/>
      <ul id="top10"></ul>
      <div id="shareButtons"></div>
    </div>
  </div>
</div>

<!-- ========================= WAITLIST MODAL ========================= -->
<div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-labelledby="wl-title">
  <div class="modal" id="modalBox">
    <div class="row">
      <h3 id="wl-title" style="margin:0">Join the LockHabit waitlist</h3>
      <button class="x" aria-label="Close" onclick="closeModal()">✕</button>
    </div>
    <p class="note">Be first in line when invites open. We’ll only email you about LockHabit.</p>
    <form id="wl-form" class="form" novalidate>
      <input type="email" name="email" placeholder="Email address" required aria-label="Email address"/>
      <input type="text" name="name" placeholder="Name (optional)" aria-label="Name"/>
      <select name="term" aria-label="Preferred lock term">
        <option value="">Preferred lock term (optional)</option>
        <option value="3">3 months</option>
        <option value="6">6 months</option>
        <option value="12" selected>12 months</option>
        <option value="24+">24+ months</option>
      </select>
      <button class="btn acc" type="submit">Join the waitlist</button>
      <div id="msg" class="note" role="status" aria-live="polite"></div>
      <div class="footnote">By joining, you consent to receive early-access communications. We never sell your data.</div>
    </form>
    <div id="ok" class="success" aria-live="polite">
      <div class="check">✅</div>
      <h3>Thanks — you’re on the list!</h3>
      <p class="note">We’ve recorded your interest. Keep an eye on your inbox for updates.</p>
      <button class="btn acc" onclick="closeModal()">Back to home</button>
    </div>
  </div>
</div>

<!-- ========================= Structured data (SEO) ========================= -->
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Organization","name":"LockHabit","url":"https://lockhabit.com/","logo":"/public/logo.svg","sameAs":["https://twitter.com/lockhabit","https://www.linkedin.com/company/lockhabit"]}
</script>

<!-- ========================= SCRIPTS ========================= -->
<script>
  /* Live year */
  document.getElementById('yr').textContent = new Date().getFullYear();

  /* Sticky header hide/show */
  (function(){
    const hdr = document.getElementById('hdr');
    let lastY = window.scrollY, ticking = false;
    const onScroll = ()=>{
      const y = window.scrollY;
      hdr.classList.toggle('stuck', y > 2);
      if (y > lastY && y > 80) hdr.classList.add('hide'); else hdr.classList.remove('hide');
      lastY = y; ticking = false;
    };
    window.addEventListener('scroll', ()=>{
      if(!ticking){ window.requestAnimationFrame(onScroll); ticking = true; }
    }, {passive:true});
  })();

  /* Modal open/close */
  const overlay = document.getElementById('overlay');
  function openModal(){ overlay.style.display='flex'; document.body.style.overflow='hidden'; }
  function closeModal(){ overlay.style.display='none'; document.body.style.overflow=''; }
  window.openModal = openModal; window.closeModal = closeModal;

  /* ================== HERO CALC (simple monthly comp) ================== */
  (function(){
    const depInput = document.getElementById('depInput');
    const termInput= document.getElementById('termInput');
    const aprPills = Array.from(document.querySelectorAll('.aprRow .pill[data-apr]'));
    const aprCustom= document.getElementById('aprCustom');
    const pbar = document.getElementById('pbar'), pval = document.getElementById('pval');
    const vD = document.getElementById('vDeposited'), vI = document.getElementById('vInterest'), vT = document.getElementById('vTotal');
    const mDep = document.getElementById('mDep'), mTerm = document.getElementById('mTerm'), mAPR = document.getElementById('mAPR');

    let APR = 0.02; // default pill 2.0%

    function currency(n){ return n.toLocaleString(undefined,{style:'currency',currency:'USD'}); }

    function project(dep, months, apr){
      const r = apr / 12;
      let bal = 0, contrib = 0;
      for(let m=0;m<months;m++){
        contrib += dep;
        bal = (bal + dep) * (1 + r);
      }
      return {contrib, interest: Math.max(0, bal - contrib), total: bal};
    }

    function setAPR(val){
      APR = Math.max(0, Math.min(0.2, Number(val)||0));
      aprPills.forEach(b=>b.classList.toggle('is-active', Number(b.dataset.apr)===APR));
      mAPR.textContent = (APR*100).toFixed(1) + '% APR';
    }

    aprPills.forEach(b=>{
      b.addEventListener('click', ()=>{ setAPR(b.dataset.apr); render(); });
    });
    aprCustom.addEventListener('input', ()=>{ setAPR(aprCustom.value); render(); });

    function render(){
      const dep = Math.max(0, Number(depInput.value||0));
      const mon = Math.max(1, Math.floor(Number(termInput.value||12)));

      const out = project(dep, mon, APR);

      vD.textContent = currency(out.contrib);
      vI.textContent = currency(out.interest);
      vT.textContent = currency(out.total);

      mDep.textContent = currency(dep);
      mTerm.textContent = mon + ' months';

      // Friendly progress loop (visual)
      let prog = 0;
      if(window.__heroTimer) clearInterval(window.__heroTimer);
      window.__heroTimer = setInterval(()=>{
        prog = (prog + 1.3 + Math.random()*1.0) % 100;
        pbar.style.width = prog.toFixed(0)+'%';
        pval.textContent = prog.toFixed(0)+'%';
      }, 700);
    }

    // init
    render();
  })();

  /* ================== Waitlist submit (API + Formspree fallback) ================== */
  (function(){
    const form = document.getElementById('wl-form');
    const msg  = document.getElementById('msg');
    const ok   = document.getElementById('ok');
    if(!form) return;

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      msg.textContent = 'Submitting…';
      msg.style.color = '#60708c';

      const data = Object.fromEntries(new FormData(form).entries());
      const showOK = ()=>{ form.style.display='none'; ok.style.display='block'; };

      try{
        const res = await fetch('/api/waitlist', {
          method:'POST', headers:{'Content-Type':'application/json'},
          body:JSON.stringify(data)
        });
        const out = await res.json().catch(()=>({}));
        if(res.ok && (out.ok || out.id || out.inserted)){ showOK(); return; }
      }catch(_){}

      try{
        const fs = await fetch('https://formspree.io/f/mrbywgpw', {
          method:'POST', headers:{'Accept':'application/json'}, body:new FormData(form)
        });
        if(fs.ok){ showOK(); return; }
        msg.textContent = 'Network error. Please try again.'; msg.style.color = '#b42318';
      }catch(e){
        msg.textContent = 'Network error. Please try again.'; msg.style.color = '#b42318';
      }
    });
  })();

  /* ================== Mini Runner — now pauses on death ================== */
  (function(){
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const toggleBtn = document.getElementById('toggleGame');
    const panel     = document.getElementById('gamePanel');
    const cvs       = document.getElementById('runnerCanvas');
    const scoreEl   = document.getElementById('gameScore');
    const overBox   = document.getElementById('gameOverBox');
    const finalScore= document.getElementById('finalScore');
    const tryAgain  = document.getElementById('tryAgainBtn');
    const closeGame = document.getElementById('closeGameBtn');

    if(!toggleBtn || !panel || !cvs || !scoreEl) return;
    const ctx = cvs.getContext('2d');
    let W = cvs.width, H = cvs.height;

    let running=false, paused=false, gameOver=false, t0=0, score=0, raf;
    const G=0.9, ground=H-18;
    const player={x:40,y:ground,vy:0,w:14,h:14,onGround:true};
    let obs=[], spawn=0;

    function reset(){ score=0; obs=[]; spawn=0; player.y=ground; player.vy=0; player.onGround=true; paused=false; gameOver=false; overBox.style.display='none'; }
    function jump(){ if(!running || paused || gameOver) return; if(player.onGround){ player.vy=-12; player.onGround=false; } }
    function drawBg(){ ctx.fillStyle='#0f172a'; ctx.fillRect(0,0,W,H); ctx.strokeStyle='#26304a'; ctx.lineWidth=2; ctx.beginPath(); ctx.moveTo(0,ground+8); ctx.lineTo(W,ground+8); ctx.stroke(); }
    function drawPlayer(){ ctx.fillStyle='#e6eaff'; ctx.fillRect(player.x, player.y-player.h, player.w, player.h); }
    function addObstacle(){ const h=10+Math.floor(Math.random()*18); const w=8+Math.floor(Math.random()*10); const speed=4+Math.random()*2; obs.push({x:W+10,y:ground,w,h,v:speed}); }
    function drawObstacles(){ ctx.fillStyle='#91a1ff'; for(const o of obs){ ctx.fillRect(o.x,o.y-o.h,o.w,o.h); } }
    function collide(a,b){ return !(a.x+a.w<b.x || a.x>b.x+b.w || a.y<a.y /* dummy */ || a.y-a.h>b.y) && !(a.x+a.w<b.x || a.x>b.x+b.w || a.y<b.y-b.h || a.y-a.h>b.y); }

    function resize(){
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio||1));
      const cssW = Math.min(1200, document.documentElement.clientWidth);
      cvs.style.width = cssW + 'px';
      cvs.width = cssW * dpr; cvs.height = 140 * dpr; ctx.setTransform(dpr,0,0,dpr,0,0);
      W = cssW;
    }
    window.addEventListener('resize', resize, {passive:true}); resize();

    function step(ts){
      if(!running){ return; }
      if(prefersReduced){ paused=true; }
      if(paused || gameOver){ raf = requestAnimationFrame(step); return; }
      if(!t0) t0 = ts; const dt = Math.min(32, ts - t0); t0 = ts;

      player.vy += G; player.y += player.vy;
      if(player.y >= ground){ player.y = ground; player.vy = 0; player.onGround = true; }

      spawn -= dt; if(spawn <= 0){ addObstacle(); spawn = 800 + Math.random()*900; }
      for(const o of obs){ o.x -= o.v; } obs = obs.filter(o => o.x + o.w > -10);

      for(const o of obs){
        if(!(player.x + player.w < o.x || player.x > o.x + o.w || player.y < o.y - o.h || player.y - player.h > o.y)){
          // hit
          gameOver = true; paused = true; finalScore.textContent = score.toString(); overBox.style.display='flex';
          break;
        }
      }

      score += Math.floor(dt/10);
      scoreEl.textContent = 'Score: ' + score;

      drawBg(); drawObstacles(); drawPlayer();
      raf = requestAnimationFrame(step);
    }

    function start(){ if(running) return; reset(); running = true; paused = false; t0 = 0; raf = requestAnimationFrame(step); }
    function stop(){ running = false; paused = false; cancelAnimationFrame(raf); overBox.style.display='none'; }

    window.addEventListener('keydown', (e)=>{
      if(panel.classList.contains('open')){
        if(e.code === 'Space' || e.code === 'ArrowUp'){ e.preventDefault(); jump(); }
        if(e.code === 'KeyR'){ reset(); }
        if(e.code === 'KeyP'){ paused = !paused; }
      }
    });
    cvs.addEventListener('touchstart', (e)=>{ if(panel.classList.contains('open')){ e.preventDefault(); jump(); } }, {passive:false});

    toggleBtn.addEventListener('click', ()=>{
      const open = panel.classList.toggle('open');
      toggleBtn.setAttribute('aria-expanded', String(open));
      toggleBtn.textContent = open ? '🎮 Mini game (on)' : '🎮 Mini game (off)';
      if(open){ start(); } else { stop(); }
    });

    tryAgain.addEventListener('click', ()=>{ reset(); paused=false; gameOver=false; });
    closeGame.addEventListener('click', ()=>{ panel.classList.remove('open'); stop(); });

    document.addEventListener('visibilitychange', ()=>{ if(document.hidden) paused = true; });

    const mo = new MutationObserver(()=>{ if(overlay && overlay.style.display === 'flex'){ paused = true; } });
    if(overlay) mo.observe(overlay, {attributes:true, attributeFilter:['style']});
  })();

  /* PWA SW registration */
  if('serviceWorker' in navigator){
    window.addEventListener('load', ()=> {
      navigator.serviceWorker.register('/public/sw.js').then(
        ()=>console.log('✅ Service Worker registered'),
        err=>console.error('❌ SW registration failed:', err)
      );
    });
  }
</script>
</body>
</html>
