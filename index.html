<!doctype html>
<html lang="en">
<head>
  <!-- =========================================================
       LockHabit — Weekly 10y mock • APR selector • Compounding
       ========================================================= -->
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>LockHabit — Discipline Pays. Lock Your Money. Own Your Future.</title>
  <meta name="description" content="LockHabit is a behavioral savings vault. Weekly hard-locks, compounding interest, and self-backed emergency credit. Try the live calculator demo."/>
  <meta name="theme-color" content="#6f7cff"/>

  <!-- Canonical + Social -->
  <link rel="canonical" href="https://lockhabit.com/"/>
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="LockHabit — Discipline Pays. Lock Your Money. Own Your Future."/>
  <meta property="og:description" content="Weekly lock • 10 years • Pick 3.25% APR, 3.5% APR, or a high-risk 7.8–20% variable APR. See your projected balance with compounding."/>
  <meta property="og:url" content="https://lockhabit.com/"/>
  <meta property="og:image" content="/public/og-image.png"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="LockHabit — Save on purpose"/>
  <meta name="twitter:description" content="Check your take-home, build a plan, and see your savings grow in the live demo."/>
  <meta name="twitter:image" content="/public/og-image.png"/>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>

  <!-- Icons & PWA -->
  <link rel="icon" href="/public/favicon.svg" type="image/svg+xml">
  <link rel="alternate icon" href="/public/favicon.ico">
  <link rel="apple-touch-icon" href="/public/icon-192.png">
  <link rel="manifest" href="/public/manifest.webmanifest">

  <!-- Analytics -->
  <script defer data-domain="lockhabit.com" src="https://plausible.io/js/script.js"></script>

  <!-- ========================= Styles ========================= -->
  <style>
    :root{
      --brand:#6f7cff; --brand-2:#9c78ff; --accent:#9fb2ff;
      --green:#22c55e; --ink:#0f172a; --muted:#536179;
      --line:#e6e7f1; --panel:#ffffff; --surface:#fbfcff;
      --bg:#0b0e1a;
      --radius-sm:12px; --radius:16px; --radius-lg:22px;
      --shadow-elev:0 18px 50px rgba(17,24,39,.10);
      --shadow-deep:0 40px 120px rgba(7,10,18,.45);
      --grad-hero:
        radial-gradient(1400px 750px at 50% -200px, rgba(111,124,255,.30) 0%, rgba(156,120,255,.20) 35%, transparent 60%),
        radial-gradient(1100px 700px at -10% 10%, rgba(156,120,255,.22) 0%, transparent 55%),
        radial-gradient(1100px 700px at 110% -20%, rgba(111,124,255,.18) 0%, transparent 60%),
        #f8f9ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font:16px/1.6 Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      padding-bottom: env(safe-area-inset-bottom, 0px); overflow-x:hidden;
    }

    /* Header (mobile-first) */
    .header{
      position:sticky; top:0; z-index:60;
      background:rgba(255,255,255,.92); backdrop-filter:blur(10px);
      border-bottom:1px solid var(--line);
      transform:translateY(0); transition:transform .18s ease, box-shadow .18s ease;
    }
    .header.stuck{ box-shadow:0 6px 20px rgba(17,24,39,.08); }
    .header.hide{ transform:translateY(-100%); }
    .wrap{
      max-width:1200px;margin:0 auto;padding:12px 16px;
      display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    .brand{display:flex;align-items:center;gap:10px;min-width:0}
    .logo{width:28px;height:28px;flex:none}
    .word{font-weight:800;font-size:18px;color:#0e1a34;white-space:nowrap}
    .nav{display:flex;align-items:center;gap:14px;min-width:0;}
    .nav a{color:#19253f;text-decoration:none;font-weight:600;white-space:nowrap}
    .btn{
      appearance:none;border:1px solid var(--line);background:#fff;
      padding:10px 14px;border-radius:12px;font-weight:800;cursor:pointer;
      min-height:44px;-webkit-tap-highlight-color:transparent;touch-action:manipulation
    }
    .btn.acc{background:linear-gradient(135deg, var(--brand), var(--brand-2));color:#fff;border-color:transparent;box-shadow:0 10px 26px rgba(111,124,255,.32)}
    .btn.ghost{background:transparent}
    .btn.pill{border-radius:999px}
    @media (max-width:720px){ .nav a{display:none} .btn.ghost{display:none} }

    /* Hero */
    .hero{background:var(--grad-hero);border-bottom:1px solid var(--line);padding:52px 16px 40px}
    .hero-grid{max-width:1200px;margin:0 auto;display:grid;grid-template-columns:1fr;gap:22px;align-items:center}
    @media (min-width:1000px){ .hero-grid{grid-template-columns:1.05fr .95fr; gap:28px} }
    h1{font-size:32px;line-height:1.18;margin:0 0 8px}
    @media (min-width:480px){ h1{font-size:40px} }
    @media (min-width:1000px){ h1{font-size:48px} }
    .sub{color:#3a4a66;max-width:65ch}

    .chip{
      display:flex;align-items:center;gap:12px;flex-wrap:wrap;
      padding:8px 12px;border-radius:999px;background:linear-gradient(135deg,#e7ebff,#f4f1ff);
      border:1px solid #dfe3ff;font-weight:700;color:#3a4a66;max-width:100%;
    }
    .chip span{white-space:nowrap}
    .chip span+span{position:relative;padding-left:18px}
    .chip span+span::before{content:"•";position:absolute;left:6px;top:0;color:#7f8bb3}

    .cta{display:flex;gap:10px;margin-top:16px;flex-wrap:wrap}
    .cta .btn{padding:12px 16px}

    /* Mock card (tracker) */
    .mock{
      background:#fff;border:1px solid var(--line);border-radius:20px;
      padding:16px;box-shadow:var(--shadow-elev);position:relative;overflow:hidden
    }
    .mock .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .badge-green{background:#eafff2;color:#0b3b22;border:1px solid #c8f5d9;padding:6px 10px;border-radius:999px;font-weight:800;white-space:nowrap}
    .mini{font-size:12px;color:var(--muted)}
    .card{margin-top:12px;background:linear-gradient(180deg,#fff,#f9f9ff);border:1px solid var(--line);border-radius:14px;padding:12px}
    .bar{height:10px;border-radius:999px;background:#edf0f6;overflow:hidden;border:1px solid #e5e8f1}
    .fill{height:100%;width:0;background:linear-gradient(90deg,#22c55e,var(--brand));transition:width .6s ease}
    .statgrid{display:grid;grid-template-columns:1fr;gap:10px;margin-top:12px}
    @media (min-width:560px){ .statgrid{grid-template-columns:repeat(3,minmax(0,1fr))} }
    .stat{background:#fff;border:1px solid var(--line);border-radius:12px;padding:12px}
    .k{font-size:12px;color:#5c6b86;letter-spacing:.04em;text-transform:uppercase}
    .v{font-weight:800;font-size:22px;color:#0b1230;line-height:1.2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

    .subrow{display:flex;align-items:center;gap:8px;flex-wrap:wrap;}
    .pillInfo{display:inline-flex;align-items:center;gap:8px;background:#f3f5ff;border:1px solid #e1e6ff;border-radius:999px;padding:8px 12px;font-weight:700;color:#203060}

    /* Sections */
    section.s{max-width:1200px;margin:0 auto;padding:36px 16px}
    @media (min-width:768px){ section.s{padding:44px 22px} }
    .section-title{font-size:26px;text-align:center;margin:0 0 16px;color:#f8f9ff}
    @media (min-width:768px){ .section-title{font-size:30px} }
    .panel{background:#fff;border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:var(--shadow-elev)}
    @media (min-width:768px){ .panel{padding:24px} }

    .cols3{display:grid;grid-template-columns:1fr;gap:12px}
    @media (min-width:900px){ .cols3{grid-template-columns:repeat(3,minmax(0,1fr))} }
    .plan{background:#fff;border:1px solid var(--line);border-radius:16px;padding:16px}
    .plan h3{margin:0 0 6px;color:#15213d}
    .plan ul{margin:8px 0 0;padding-left:18px;color:#3b4a67}

    .trustgrid{display:grid;grid-template-columns:1fr;gap:12px}
    @media (min-width:900px){ .trustgrid{grid-template-columns:repeat(3,minmax(0,1fr))} }
    .trust{background:#fff;border:1px solid var(--line);border-radius:16px;padding:16px}
    .trust b{color:#101828}

    /* Ribbon */
    .ribbon{background:linear-gradient(135deg, rgba(111,124,255,.22), rgba(156,120,255,.22));border-top:1px solid var(--line);border-bottom:1px solid var(--line)}
    .ribwrap{max-width:1200px;margin:0 auto;padding:12px 16px;display:flex;gap:10px;align-items:center;justify-content:center;color:#e7ebff;flex-wrap:wrap}
    .ribwrap .item{display:flex;align-items:center;gap:8px;background:rgba(255,255,255,.18);border:1px solid rgba(255,255,255,.25);padding:10px 12px;border-radius:999px}
    .ribwrap .item b{color:#fff}

    /* Footer */
    footer{background:#fff;border-top:1px solid var(--line);color:#3a4a66}
    .foot{max-width:1200px;margin:0 auto;padding:22px 16px}
    .fine{background:#f6f7fc;border:1px solid var(--line);border-radius:12px;padding:12px;margin-top:12px;font-size:12px;color:#41506a}
    .footnote{font-size:12px;color:#60708c}

    /* Modal (waitlist) */
    .overlay{position:fixed;inset:0;background:rgba(9,12,22,.55);backdrop-filter:blur(3px);display:none;align-items:center;justify-content:center;z-index:90}
    .modal{width:min(560px,92vw);background:#fff;border:1px solid var(--line);border-radius:16px;padding:18px;box-shadow:var(--shadow-deep)}
    .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .x{border:0;background:transparent;font-size:20px;cursor:pointer;color:#64748b}
    .form{display:grid;gap:10px;margin-top:10px}
    input,select{padding:14px;border-radius:12px;border:1px solid #dbe0ea;font-size:16px}
    .note{font-size:12px;color:#60708c}
    .success{display:none;text-align:center;padding:18px}
    .check{font-size:42px}

    /* Mini Game */
    .miniwrap{position:fixed;left:0;right:0;bottom:0;z-index:40;pointer-events:none}
    .minibar{margin:0 auto;max-width:1200px;padding:6px 10px;display:flex;gap:8px;align-items:center;justify-content:flex-end}
    .minibar .pill{pointer-events:auto;display:inline-flex;align-items:center;gap:8px;background:#0e1330;color:#e5e7f1;border:1px solid #2b3150;border-radius:999px;padding:6px 10px;font-weight:700;cursor:pointer;min-height:36px}
    #gamePanel{pointer-events:auto;display:none;background:#0b0e1a;border-top:1px solid #2b3150}
    #gamePanel.open{display:block}
    #runnerCanvas{display:block;width:100%;max-width:1200px;height:120px;margin:0 auto;background:#0f172a}
    #gameInfo,#gameUI{max-width:1200px;margin:0 auto;color:#9fb2ff;font-size:12px;padding:6px 10px;display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    #top10{display:flex;gap:6px;flex-wrap:wrap;padding:0;margin:0;list-style:none;opacity:.25;pointer-events:none} /* dimmed */
    #shareButtons{opacity:.25;pointer-events:none} /* dimmed */
    #playerName{padding:6px 8px;border-radius:10px;border:1px solid #2b3150;background:#0e1330;color:#e5e7f1}

    @media (max-width:420px){
      .word{font-size:17px}
      .btn{padding:10px 12px}
    }
  </style>
</head>
<body>

<!-- ========================= HEADER ========================= -->
<header class="header" role="banner" id="hdr">
  <div class="wrap">
    <div class="brand" aria-label="LockHabit">
      <svg class="logo" viewBox="0 0 120 120" aria-hidden="true">
        <defs><linearGradient id="lg" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#6f7cff"/><stop offset="100%" stop-color="#9c78ff"/></linearGradient></defs>
        <rect x="12" y="22" width="96" height="80" rx="18" fill="url(#lg)"/>
        <path d="M40 50c0-16 12-28 28-28s28 12 28 28" fill="none" stroke="#ffffff" stroke-width="8" stroke-linecap="round"/>
        <path d="M40 90V58" stroke="#ffffff" stroke-width="10" stroke-linecap="round"/>
        <path d="M40 90h26" stroke="#e7ecf8" stroke-width="8" stroke-linecap="round"/>
      </svg>
      <div class="word">LockHabit</div>
    </div>
    <nav class="nav" role="navigation" aria-label="Main">
      <a href="#how">How it works</a>
      <a href="#plans">Plans</a>
      <a href="#security">Security</a>
      <a href="/calculator.html">Calculator</a>
      <a href="/demo.html">Demo</a>
      <button class="btn acc" onclick="openModal()">Get started</button>
    </nav>
  </div>
</header>

<!-- ========================= HERO ========================= -->
<section class="hero" id="top">
  <div class="hero-grid" aria-describedby="hero-copy">
    <div>
      <div class="chip" aria-label="Highlights">
        <span>Weekly lock</span><span>10 years</span><span><b style="color:#22c55e">3.25% / 3.5% APR</b></span><span>High-risk 7.8–20% (variable)</span>
      </div>
      <h1>Discipline pays. Lock your money and own your future.</h1>
      <p id="hero-copy" class="sub">
        LockHabit turns saving into momentum. Weekly hard-locks with <b>compounding</b>, plus optional
        <b>self-backed emergency credit</b>. Choose a fixed APR or a high-risk variable APR (can lose value).
        Try the live calculator below.
      </p>
      <div class="cta">
        <button class="btn acc" onclick="openModal()">Join the Waitlist</button>
        <a class="btn" href="/calculator.html">Check your take-home</a>
        <a class="btn" href="/demo.html">Try the Demo</a>
      </div>
      <div class="footnote">Your deposits are never lent to others. Your patience earns dividends.</div>
    </div>

    <!-- Right: interactive mock -->
    <aside class="mock" aria-live="polite">
      <div class="row">
        <div>
          <div class="mini">Savings Vault</div>
          <div style="font-weight:800;font-size:18px;color:#0f1a34">Goal Progress</div>
          <div class="mini" id="planLine">Weekly lock • 10 years • <span id="planAPRText">3.5% APR</span></div>
        </div>
        <span class="badge-green">On-time ↑ credit</span>
      </div>

      <div class="card" style="margin-top:10px">
        <div class="subrow" style="justify-content:space-between;margin-bottom:8px">
          <div class="mini">Progress</div>
          <div class="mini" id="pval" aria-live="polite">0%</div>
        </div>
        <div class="bar" aria-hidden="true"><div class="fill" id="pbar"></div></div>

        <!-- Plan selector -->
        <div class="subrow" style="margin-top:10px">
          <label class="mini" for="aprPlan"><b>Plan:</b></label>
          <select id="aprPlan" aria-label="APR plan">
            <option value="fixed325">Fixed 3.25% APR</option>
            <option value="fixed350" selected>Fixed 3.5% APR</option>
            <option value="variable">High-Risk 7.8–20% APR (variable; may lose value)</option>
          </select>
        </div>
      </div>

      <div class="statgrid">
        <div class="stat">
          <div class="k">Locked today</div>
          <div class="v" id="lockedNow">$3,000.00</div>
          <div class="k">Auto-deposit $200 weekly</div>
        </div>
        <div class="stat">
          <div class="k">Projected interest</div>
          <div class="v" id="intv">$0.00</div>
          <div class="k" id="aprNote">at 3.5% APR (10 yrs)</div>
        </div>
        <div class="stat">
          <div class="k">Account balance</div>
          <div class="v" id="acctVal">$0.00</div>
          <div class="k">Principal + deposits + interest</div>
        </div>
      </div>

      <div class="card" style="margin-top:12px;display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap">
        <div class="pillInfo" id="emergPill" title="Self-backed emergency loan">
          💡 Emergency loan available: <span id="emergVal">$0.00</span>
        </div>
        <button class="btn acc pill" id="heroJoin">Join the waitlist</button>
      </div>

      <div class="mini" id="feeLine" style="margin-top:6px">Emergency withdrawal fee: <b>5%</b></div>
    </aside>
  </div>
</section>

<!-- ========================= RIBBON ========================= -->
<div class="ribbon" role="region" aria-label="Security summary">
  <div class="ribwrap">
    <div class="item">🔒 <b>Hard-lock</b> (no early withdrawals except emergencies)</div>
    <div class="item">🏦 <b>FDIC-backed custody</b> via partner banks</div>
    <div class="item">📈 <b>Self-backed emergency credit</b></div>
    <div class="item">🧮 <b>APR options:</b> 3.25% • 3.5% • High-risk 7.8–20% (variable)</div>
  </div>
</div>

<!-- ========================= HOW IT WORKS ========================= -->
<section id="how" class="s" aria-labelledby="how-title">
  <h2 id="how-title" class="section-title">How LockHabit Works</h2>
  <div class="panel">
    <div class="cols3">
      <div class="plan">
        <h3>1) Choose your lock</h3>
        <ul>
          <li>Pick weekly term targets (e.g., 10-year discipline run)</li>
          <li>Auto-deposit (weekly) to build momentum</li>
          <li>Funds move into your hidden vault</li>
        </ul>
      </div>
      <div class="plan">
        <h3>2) Grow automatically</h3>
        <ul>
          <li>Compounded weekly</li>
          <li>Fixed APRs (3.25% or 3.5%) or variable high-risk 7.8–20%</li>
          <li>Your money is <b>never lent out</b></li>
        </ul>
      </div>
      <div class="plan">
        <h3>3) Unlock or borrow</h3>
        <ul>
          <li>Unlock day: principal + interest − small flat/posted fees</li>
          <li>Emergency? Borrow against your own balance (self-backed)</li>
          <li>Intended to be <b>credit-bureau reported</b></li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- ========================= PLANS ========================= -->
<section id="plans" class="s" aria-labelledby="plans-title">
  <h2 id="plans-title" class="section-title">Simple, transparent plans</h2>
  <div class="cols3">
    <div class="plan">
      <h3>Fixed 3.25% APR</h3>
      <ul>
        <li>Weekly compounding</li>
        <li>Great for long-horizon savers</li>
        <li>Small flat unlock fee</li>
      </ul>
    </div>
    <div class="plan">
      <h3>Fixed 3.5% APR</h3>
      <ul>
        <li>Weekly compounding</li>
        <li>Our most popular fixed plan</li>
        <li>Small flat unlock fee</li>
      </ul>
    </div>
    <div class="plan">
      <h3>High-Risk 7.8–20% APR*</h3>
      <ul>
        <li>Variable return; may experience drawdowns</li>
        <li>Not suitable for all users</li>
        <li><i>*Balance can decrease during losses</i></li>
      </ul>
    </div>
  </div>
</section>

<!-- ========================= SECURITY / TRUST ========================= -->
<section id="security" class="s" aria-labelledby="sec-title">
  <h2 id="sec-title" class="section-title">Your money stays safe</h2>
  <div class="panel">
    <div class="trustgrid">
      <div class="trust">
        <b>FDIC-backed via partner banks</b>
        <p class="mini">When deposits are held at partner banks and structured for pass-through coverage, FDIC insurance applies up to legal limits per depositor, per bank.</p>
      </div>
      <div class="trust">
        <b>Segregated & never lent</b>
        <p class="mini">Your funds remain reserved for you — <b>we do not lend out customer deposits</b>. Emergency access is a secured, self-backed loan to <i>you</i>, not others.</p>
      </div>
      <div class="trust">
        <b>Hard-lock with emergency override</b>
        <p class="mini">Withdrawals aren’t allowed before the unlock date except for approved emergencies. Non-emergency early break attempts incur posted fees.</p>
      </div>
      <div class="trust">
        <b>Credit-builder emergency loans</b>
        <p class="mini">Borrow against your own balance; loans are intended to be reported to major bureaus. On-time payments may help build credit; late payments may harm credit.</p>
      </div>
      <div class="trust">
        <b>Privacy & transparency</b>
        <p class="mini">We keep your data private and use it only to operate LockHabit. No dark patterns — just clear terms.</p>
      </div>
    </div>
  </div>
</section>

<!-- ========================= FAQ ========================= -->
<section id="faq" class="s" aria-labelledby="faq-title">
  <h2 id="faq-title" class="section-title">FAQ</h2>
  <div class="panel" aria-live="polite">
    <details>
      <summary>Is this a hard lock?</summary>
      <p>Yes. Funds remain locked until the chosen unlock date. Early withdrawal is not permitted except for approved emergencies. Non-emergency early break attempts incur posted fees.</p>
    </details>
    <details>
      <summary>Do I earn interest while locked?</summary>
      <p>Yes. Balances compound weekly. Fixed plans use a posted APR (e.g., 3.25% or 3.5%). Variable plans can fluctuate and may lose value.</p>
    </details>
    <details>
      <summary>Are emergency loans credit-builder loans?</summary>
      <p>Emergency self-loans are intended to be reported to credit bureaus. On-time payments may help build credit; missed or late payments may harm credit.</p>
    </details>
    <details>
      <summary>Is my money FDIC insured?</summary>
      <p>Deposits are held at regulated partner banks. When structured for pass-through coverage, balances are eligible for FDIC insurance up to applicable limits per depositor, per bank.</p>
    </details>
  </div>
</section>

<!-- ========================= FOOTER ========================= -->
<footer role="contentinfo">
  <div class="foot">
    <div>© <span id="yr"></span> LockHabit — Discipline made simple. Contact: <a href="mailto:lockhabit@outlook.com">lockhabit@outlook.com</a></div>
    <div class="fine">
      LockHabit is a financial technology company, not a bank. Banking services and deposit custody are provided by regulated partner banks.
      When deposits are held at partner banks and structured for pass-through coverage, funds may be eligible for FDIC insurance up to the applicable limits per depositor, per bank.
      This is a <b>hard lock</b>: early withdrawal is not permitted except for approved emergencies. Emergency access is provided via secured, self-backed loans. APRs, terms, and fees are subject to change with notice. Variable APR plans may lose value.
    </div>
    <div class="footnote" style="margin-top:8px;text-align:center">
      <a href="/terms.html">Terms</a> • <a href="/privacy.html">Privacy</a> • <a href="/security.html">Security</a> • <a href="/calculator.html">Calculator</a> • <a href="/demo.html">Demo</a>
    </div>
  </div>
</footer>

<!-- ========================= MINI GAME (Footer) ========================= -->
<div class="miniwrap" aria-hidden="false">
  <div class="minibar">
    <button id="toggleGame" class="pill" aria-expanded="false" aria-controls="gamePanel">🎮 Mini game (off)</button>
  </div>
  <div id="gamePanel" role="region" aria-label="Endless runner mini game">
    <canvas id="runnerCanvas" width="1200" height="120"></canvas>
    <div id="gameInfo">
      <span>Until launch: Space/↑ to jump • P pause • R reset</span>
      <span id="gameScore">Score: 0</span>
    </div>
    <div id="gameUI">
      <input id="playerName" placeholder="Enter name for leaderboard (disabled)" maxlength="12" disabled/>
      <ul id="top10"></ul>
      <div id="shareButtons"></div>
    </div>
  </div>
</div>

<!-- ========================= WAITLIST MODAL ========================= -->
<div id="overlay" class="overlay" role="dialog" aria-modal="true" aria-labelledby="wl-title">
  <div class="modal" id="modalBox">
    <div class="row">
      <h3 id="wl-title" style="margin:0">Join the LockHabit waitlist</h3>
      <button class="x" aria-label="Close" onclick="closeModal()">✕</button>
    </div>
    <p class="note">Be first in line when invites open. We’ll only email you about LockHabit.</p>
    <form id="wl-form" class="form" novalidate>
      <input type="email" name="email" placeholder="Email address" required aria-label="Email address"/>
      <input type="text" name="name" placeholder="Name (optional)" aria-label="Name"/>
      <select name="term" aria-label="Preferred lock term">
        <option value="">Preferred lock term (optional)</option>
        <option value="10y-weekly" selected>10 years (weekly)</option>
      </select>
      <button class="btn acc" type="submit">Join the waitlist</button>
      <div id="msg" class="note" role="status" aria-live="polite"></div>
      <div class="footnote">By joining, you consent to receive early-access communications. We never sell your data.</div>
    </form>
    <div id="ok" class="success" aria-live="polite">
      <div class="check">✅</div>
      <h3>Thanks — you’re on the list!</h3>
      <p class="note">We’ve recorded your interest. Keep an eye on your inbox for updates.</p>
      <button class="btn acc" onclick="closeModal()">Back to home</button>
    </div>
  </div>
</div>

<!-- ========================= STRUCTURED DATA (SEO) ========================= -->
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Organization","name":"LockHabit","url":"https://lockhabit.com/","logo":"/public/logo.svg","sameAs":["https://twitter.com/lockhabit","https://www.linkedin.com/company/lockhabit"]}
</script>

<!-- ========================= SCRIPTS ========================= -->
<script>
  /* Live year */
  document.getElementById('yr').textContent = new Date().getFullYear();

  /* Sticky header behavior */
  (function(){
    const hdr = document.getElementById('hdr');
    let lastY = window.scrollY, ticking = false;
    const onScroll = ()=>{
      const y = window.scrollY;
      hdr.classList.toggle('stuck', y > 2);
      if (y > lastY && y > 80) hdr.classList.add('hide'); else hdr.classList.remove('hide');
      lastY = y; ticking = false;
    };
    window.addEventListener('scroll', ()=>{
      if(!ticking){ window.requestAnimationFrame(onScroll); ticking = true; }
    }, {passive:true});
  })();

  /* Modal */
  const overlay = document.getElementById('overlay');
  function openModal(){ overlay.style.display='flex'; document.body.style.overflow='hidden'; }
  function closeModal(){ overlay.style.display='none'; document.body.style.overflow=''; }
  window.openModal = openModal; window.closeModal = closeModal;

  /* =========== Calculator assumptions (10y weekly) =========== */
  (function(){
    const pbar = document.getElementById('pbar');
    const pval = document.getElementById('pval');
    const intv = document.getElementById('intv');
    const acctVal = document.getElementById('acctVal');
    const lockedNow = document.getElementById('lockedNow');
    const emergSpan = document.getElementById('emergVal');
    const planLine = document.getElementById('planLine');
    const planAPRText = document.getElementById('planAPRText');
    const aprNote = document.getElementById('aprNote');
    const aprPlan = document.getElementById('aprPlan');

    /* Inputs */
    const INIT = 3000;           // $3k initial
    const WEEKLY = 200;          // $200 weekly deposit
    const YEARS = 10;
    const WEEKS_TOTAL = YEARS * 52;

    /* Emergency LTV (self-backed). Change if you prefer 1.0 == 100% */
    const EMERG_LTV = 1.0;

    if(lockedNow){ lockedNow.textContent = currency(INIT); }

    function weeklyRateFromAPR(apr){ return Math.pow(1+apr, 1/52) - 1; }

    function currency(n){ return n.toLocaleString(undefined,{style:'currency',currency:'USD',maximumFractionDigits:2}); }

    /* Variable plan generator: random annual rate in [0.078, 0.20], but
       simulate monthly noise that can be negative to illustrate risk. */
    function simulateVariableProjection(){
      const annual = 0.078 + Math.random()*(0.20-0.078);
      const weeklyBase = weeklyRateFromAPR(annual);
      let bal = INIT;
      let interestAccrued = 0;

      for(let w=1; w<=WEEKS_TOTAL; w++){
        // Add weekly deposit at start of week
        bal += WEEKLY;

        // Random noise: approx normal around weeklyBase with sd ~ 0.6*weeklyBase
        const noise = (Math.random()*2-1) * weeklyBase * 0.6;
        const r = weeklyBase + noise;

        const i = bal * r;
        bal += i;
        interestAccrued += i;
      }
      return {interest: Math.max(0, interestAccrued), balance: Math.max(0, bal), aprShown: annual};
    }

    function project(aprKind){
      if(aprKind === 'variable'){
        const sim = simulateVariableProjection();
        return {interest: sim.interest, balance: sim.balance, label:`~${(sim.aprShown*100).toFixed(1)}% avg (variable)`};
      }

      const APR = (aprKind === 'fixed325' ? 0.0325 : 0.035);
      const r = weeklyRateFromAPR(APR);

      let bal = INIT;
      let interestAccrued = 0;

      for(let w=1; w<=WEEKS_TOTAL; w++){
        bal += WEEKLY;           // deposit at week start
        const i = bal * r;       // interest on full balance that week
        bal += i;
        interestAccrued += i;
      }
      return {interest: interestAccrued, balance: bal, label: (APR*100).toFixed(2)+'% APR'};
    }

    /* Fit long numbers by shrinking font-size a bit */
    function fitNumber(el){
      if(!el) return;
      const len = (el.textContent || '').length;
      el.style.fontSize = (len > 14 ? 18 : 22) + 'px';
    }

    function render(){
      const kind = aprPlan.value;
      const proj = project(kind);

      intv.textContent = currency(proj.interest);
      acctVal.textContent = currency(proj.balance);

      fitNumber(intv);
      fitNumber(acctVal);

      const emerg = Math.max(0, proj.balance * EMERG_LTV);
      if(emergSpan) { emergSpan.textContent = currency(emerg); fitNumber(emergSpan); }

      if(planAPRText) planAPRText.textContent = (kind==='variable'?'High-risk variable':proj.label);
      if(aprNote) aprNote.textContent = (kind==='variable' ? 'variable return; may lose value' : `at ${proj.label} (10 yrs)`);

      // Animate a friendly progress meter (visual only)
      let prog = 0;
      if(window.__lhProgTimer) clearInterval(window.__lhProgTimer);
      window.__lhProgTimer = setInterval(()=>{
        prog = (prog + 1.5 + Math.random()*1.1) % 100;
        if(pbar) pbar.style.width = prog.toFixed(0)+'%';
        if(pval) pval.textContent = prog.toFixed(0)+'%';
      }, 700);
    }

    aprPlan.addEventListener('change', render);
    render(); // initial
  })();

  /* Wire the hero “Join the waitlist” button to your modal */
  (function(){
    const btn = document.getElementById('heroJoin');
    if(!btn) return;
    btn.addEventListener('click', openModal);
  })();

  /* Waitlist submit — /api/waitlist then Formspree fallback */
  (function(){
    const form = document.getElementById('wl-form');
    const msg  = document.getElementById('msg');
    const ok   = document.getElementById('ok');
    if(!form) return;

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      msg.textContent = 'Submitting…';
      msg.style.color = '#60708c';

      const data = Object.fromEntries(new FormData(form).entries());
      const showOK = ()=>{ form.style.display='none'; ok.style.display='block'; };

      try{
        const res = await fetch('/api/waitlist', {
          method:'POST', headers:{'Content-Type':'application/json'},
          body:JSON.stringify(data)
        });
        const out = await res.json().catch(()=>({}));
        if(res.ok && (out.ok || out.id || out.inserted)){ showOK(); return; }
      }catch(_){}

      try{
        const fs = await fetch('https://formspree.io/f/mrbywgpw', {
          method:'POST', headers:{'Accept':'application/json'}, body:new FormData(form)
        });
        if(fs.ok){ showOK(); return; }
        msg.textContent = 'Network error. Please try again.'; msg.style.color = '#b42318';
      }catch(e){
        msg.textContent = 'Network error. Please try again.'; msg.style.color = '#b42318';
      }
    });
  })();

  /* ================== Mini Runner (leaderboard dimmed) ================== */
  (function(){
    const toggleBtn = document.getElementById('toggleGame');
    const panel     = document.getElementById('gamePanel');
    const cvs       = document.getElementById('runnerCanvas');
    const scoreEl   = document.getElementById('gameScore');
    if(!toggleBtn || !panel || !cvs || !scoreEl) return;

    const ctx = cvs.getContext('2d');
    let W = cvs.width, H = cvs.height;

    let running = false, paused = false, t0 = 0, score = 0, raf;
    const G = 0.9, ground = H - 18;
    const player = { x: 40, y: ground, vy: 0, w: 14, h: 14, onGround: true };
    let obs = []; let spawn = 0;

    function reset(){ score = 0; obs = []; spawn = 0; player.y = ground; player.vy = 0; player.onGround = true; paused = false; }
    function jump(){ if(!running || paused) return; if(player.onGround){ player.vy = -12; player.onGround = false; } }
    function drawBg(){ ctx.fillStyle = '#0f172a'; ctx.fillRect(0,0,W,H); ctx.strokeStyle = '#26304a'; ctx.lineWidth = 2; ctx.beginPath(); ctx.moveTo(0, ground+8); ctx.lineTo(W, ground+8); ctx.stroke(); }
    function drawPlayer(){ ctx.fillStyle = '#e6eaff'; ctx.fillRect(player.x, player.y - player.h, player.w, player.h); }
    function addObstacle(){ const h = 10 + Math.floor(Math.random()*18); const w = 8 + Math.floor(Math.random()*10); const speed = 4 + Math.random()*2; obs.push({ x: W + 10, y: ground, w, h, v: speed }); }
    function drawObstacles(){ ctx.fillStyle = '#91a1ff'; for(const o of obs){ ctx.fillRect(o.x, o.y - o.h, o.w, o.h); } }
    function collide(a,b){ return !(a.x + a.w < b.x || a.x > b.x + b.w || a.y < b.y - b.h || a.y - a.h > b.y); }

    function resize(){
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      const cssW = Math.min(1200, document.documentElement.clientWidth);
      cvs.style.width = cssW + 'px';
      cvs.width = cssW * dpr; cvs.height = 120 * dpr; ctx.setTransform(dpr,0,0,dpr,0,0);
      W = cssW;
    }
    window.addEventListener('resize', resize, {passive:true}); resize();

    function step(ts){
      if(!running){ return; }
      if(paused){ raf = requestAnimationFrame(step); return; }
      if(!t0) t0 = ts; const dt = Math.min(32, ts - t0); t0 = ts;

      player.vy += G; player.y += player.vy;
      if(player.y >= ground){ player.y = ground; player.vy = 0; player.onGround = true; }

      spawn -= dt; if(spawn <= 0){ addObstacle(); spawn = 800 + Math.random()*900; }
      for(const o of obs){ o.x -= o.v; } obs = obs.filter(o => o.x + o.w > -10);

      for(const o of obs){
        if(collide({x:player.x,y:player.y,w:player.w,h:player.h},{x:o.x,y:o.y,w:o.w,h:o.h})){
          ctx.save(); ctx.fillStyle = 'rgba(255,0,70,.18)'; ctx.fillRect(0,0,W,H); ctx.restore();
          reset(); break;
        }
      }

      score += Math.floor(dt/10);
      scoreEl.textContent = 'Score: ' + score;

      drawBg(); drawObstacles(); drawPlayer();
      raf = requestAnimationFrame(step);
    }

    function start(){ if(running) return; running = true; paused = false; t0 = 0; raf = requestAnimationFrame(step); }
    function stop(){ running = false; paused = false; cancelAnimationFrame(raf); }

    window.addEventListener('keydown', (e)=>{
      if(panel.classList.contains('open')){
        if(e.code === 'Space' || e.code === 'ArrowUp'){ e.preventDefault(); jump(); }
        if(e.code === 'KeyR'){ reset(); }
        if(e.code === 'KeyP'){ paused = !paused; }
      }
    });
    cvs.addEventListener('touchstart', (e)=>{ if(panel.classList.contains('open')){ e.preventDefault(); jump(); } }, {passive:false});

    toggleBtn.addEventListener('click', ()=>{
      const open = panel.classList.toggle('open');
      toggleBtn.setAttribute('aria-expanded', String(open));
      toggleBtn.textContent = open ? '🎮 Mini game (on)' : '🎮 Mini game (off)';
      if(open){ start(); } else { stop(); }
    });

    document.addEventListener('visibilitychange', ()=>{ if(document.hidden) paused = true; });
    const mo = new MutationObserver(()=>{ if(overlay && overlay.style.display === 'flex'){ paused = true; } });
    if(overlay) mo.observe(overlay, {attributes:true, attributeFilter:['style']});
  })();

  /* PWA SW registration */
  if('serviceWorker' in navigator){
    window.addEventListener('load', ()=> {
      navigator.serviceWorker.register('/public/sw.js').then(
        ()=>console.log('✅ Service Worker registered'),
        err=>console.error('❌ SW registration failed:', err)
      );
    });
  }
</script>
</body>
</html>